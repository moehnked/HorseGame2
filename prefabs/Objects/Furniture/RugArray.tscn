[gd_scene load_steps=9 format=2]

[ext_resource path="res://Sprites/Rugs/Rug02.png" type="Texture" id=1]
[ext_resource path="res://Sprites/Rugs/Rug07.png" type="Texture" id=2]
[ext_resource path="res://Sprites/Rugs/Rug01.png" type="Texture" id=3]
[ext_resource path="res://Sprites/Rugs/Rug03.png" type="Texture" id=4]
[ext_resource path="res://Sprites/Rugs/Rug04.png" type="Texture" id=5]

[sub_resource type="GDScript" id=1]
script/source = "tool
extends Spatial

export(Array, Texture) var rugs
export(int) var rugType = 0

var startMaterial

func _ready():
	startMaterial = $MeshInstance.get_surface_material(0).duplicate(7)
	$MeshInstance.set_surface_material(0, startMaterial)
# Called when the node enters the scene tree for the first time.
func _process(delta):
	if Engine.editor_hint:
		var pos = transform.origin
		pos = Vector3(fposmod(pos.x,0.999), fposmod(pos.y,0.999), fposmod(pos.z,0.999))
		pos = pos / 2
		$MeshInstance.get_surface_material(0).albedo_texture = rugs[rugType % rugs.size()]
		$MeshInstance.get_surface_material(0).albedo_color = Color(1,1,1,1) - Color(pos.x,pos.y,pos.z,0.0)
		$MeshInstance.get_surface_material(0).distance_fade_mode = 2
		$MeshInstance.get_surface_material(0).distance_fade_max_distance = 160
		$MeshInstance.get_surface_material(0).distance_fade_min_distance = 70
		#$MeshInstance.get_surface_material(0).albedo_color = Color(1,1,1,1)
	pass # Replace with function body.

"

[sub_resource type="QuadMesh" id=2]

[sub_resource type="SpatialMaterial" id=3]
resource_local_to_scene = true
flags_transparent = true
albedo_texture = ExtResource( 3 )

[node name="Rug" type="Spatial"]
script = SubResource( 1 )
rugs = [ ExtResource( 3 ), ExtResource( 1 ), ExtResource( 4 ), ExtResource( 5 ), ExtResource( 2 ) ]

[node name="MeshInstance" type="MeshInstance" parent="."]
transform = Transform( 1, -2.42771e-15, -1.06119e-22, 0, -4.37114e-08, 1, -2.42771e-15, -1, -4.37114e-08, 0, 0, 0 )
mesh = SubResource( 2 )
material/0 = SubResource( 3 )
